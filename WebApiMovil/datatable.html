<!DOCTYPE html>
<!--
This is a starter template page. Use this page to start your new project from
scratch. This page gets rid of all links and provides the needed markup only.
-->
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Gesti&oacute;n de Portafolio | </title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">


  <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="bower_components/Ionicons/css/ionicons.min.css">
  <!-- daterange picker -->
  <link rel="stylesheet" href="bower_components/bootstrap-daterangepicker/daterangepicker.css">
  <!-- bootstrap datepicker -->
  <link rel="stylesheet" href="bower_components/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css">
  <!-- DataTables -->
  <link rel="stylesheet" href="bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css">
  <link rel="stylesheet" href="custom_components/datatables/buttons/1.5.3/css/buttons.dataTables.min.css">
  <link rel="stylesheet" href="custom_components/datatables/select/1.2.7/css/select.dataTables.min.css">  
  <!-- Select2 -->
  <link rel="stylesheet" href="bower_components/select2/dist/css/select2.min.css">
 <!-- iCheck for checkboxes and radio inputs -->
 <link rel="stylesheet" href="plugins/iCheck/all.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="dist/css/AdminLTE.min.css">
  <!-- AdminLTE Skins. We have chosen the skin-blue for this starter
        page. However, you can choose any other skin. Make sure you
        apply the skin class to the body tag so the changes take effect. -->
  <link rel="stylesheet" href="dist/css/skins/skin-blue.min.css">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

  <!-- Google Font -->
  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
<style>
table.dataTable thead th.dt-head-nowrap,
table.dataTable thead td.dt-head-nowrap,
table.dataTable tfoot th.dt-head-nowrap,
table.dataTable tfoot td.dt-head-nowrap {
  white-space: nowrap;
}
table.dataTable thead th.dt-head-top,
table.dataTable thead td.dt-head-top,
table.dataTable tfoot th.dt-head-top,
table.dataTable tfoot td.dt-head-top {
  vertical-align: top;
}

table.dataTable tbody th.dt-body-left,
table.dataTable tbody td.dt-body-left {
  text-align: left;
}
table.dataTable tbody th.dt-body-center,
table.dataTable tbody td.dt-body-center {
  text-align: center;
}
table.dataTable tbody th.dt-body-right,
table.dataTable tbody td.dt-body-right {
  text-align: right;
}
table.dataTable tbody th.dt-body-justify,
table.dataTable tbody td.dt-body-justify {
  text-align: justify;
}
table.dataTable tbody th.dt-body-nowrap,
table.dataTable tbody td.dt-body-nowrap {
  white-space: nowrap;
}

.dataTables_scrollHeadInner table.dataTable thead th.select-checkbox {
    font-size: 1.0em;
    padding-left:2px;
    padding-right:2px;
    padding-top: 0em;
    overflow: hidden;
   white-space: nowrap; 
   opacity: 1;   
}

.dataTables_scrollHeadInner table.dataTable thead th.select-checkbox {
  cursor: pointer;
}
</style>

<style>
.logo-mini {
    background-image: url('dist/img/Indra-Sistemas-Logo.svg.png');
       background-repeat: no-repeat;
    background-size: contain;
     color:transparent;       
}
.logo-lg {
    background-image: url('dist/img/Indra-Sistemas-Logo.svg.png');
       background-repeat: no-repeat;
    background-size: contain;
    color:transparent;
}
.navbar-custom-menu .label,
.navbar-custom-menu .dropdown-menu{
    display:none
}
#example1 tr{
    cursor: pointer;
}
.icheck,
.icheckbox_square-blue,
.iradio_square-blue
{
  display:block;
  border-radius:0px;
}

</style>
</head>
<!--
BODY TAG OPTIONS:
=================
Apply one or more of the following classes to get the
desired effect
|---------------------------------------------------------|
| SKINS         | skin-blue                               |
|               | skin-black                              |
|               | skin-purple                             |
|               | skin-yellow                             |
|               | skin-red                                |
|               | skin-green                              |
|---------------------------------------------------------|
|LAYOUT OPTIONS | fixed                                   |
|               | layout-boxed                            |
|               | layout-top-nav                          |
|               | sidebar-collapse                        |
|               | sidebar-mini                            |
|---------------------------------------------------------|
-->

<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">

  <!-- Main Header -->
  <header class="main-header">

    <!-- Logo -->
    <a href="index2.html" class="logo">
      <!-- mini logo for sidebar mini 50x50 pixels -->
      <span class="logo-mini"><b>A</b>LT</span>
      <!-- logo for regular state and mobile devices -->
      <span class="logo-lg"><b>Admin</b>LTE</span>
    </a>

    <!-- Header Navbar -->
    <nav class="navbar navbar-static-top" role="navigation">
      <!-- Sidebar toggle button-->
      <a href="#" class="sidebar-toggle" data-toggle="push-menu" role="button">
        <span class="sr-only">Toggle navigation</span>
      </a>
      <!-- Navbar Right Menu -->
      <div class="navbar-custom-menu">
        <ul class="nav navbar-nav">
          <!-- Messages: style can be found in dropdown.less-->
          <li class="dropdown messages-menu">
            <!-- Menu toggle button -->
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              <i class="fa fa-envelope-o"></i>
              <span class="label label-success">4</span>
            </a>
            <ul class="dropdown-menu">
              <li class="header">You have 4 messages</li>
              <li>
                <!-- inner menu: contains the messages -->
                <ul class="menu">
                  <li><!-- start message -->
                    <a href="#">
                      <div class="pull-left">
                        <!-- User Image -->
                        <img src="dist/img/user2-160x160.jpg" class="img-circle" alt="User Image">
                      </div>
                      <!-- Message title and timestamp -->
                      <h4>
                        Support Team
                        <small><i class="fa fa-clock-o"></i> 5 mins</small>
                      </h4>
                      <!-- The message -->
                      <p>Why not buy a new awesome theme?</p>
                    </a>
                  </li>
                  <!-- end message -->
                </ul>
                <!-- /.menu -->
              </li>
              <li class="footer"><a href="#">See All Messages</a></li>
            </ul>
          </li>
          <!-- /.messages-menu -->

          <!-- Notifications Menu -->
          <li class="dropdown notifications-menu">
            <!-- Menu toggle button -->
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              <i class="fa fa-bell-o"></i>
              <span class="label label-warning">10</span>
            </a>
            <ul class="dropdown-menu">
              <li class="header">You have 10 notifications</li>
              <li>
                <!-- Inner Menu: contains the notifications -->
                <ul class="menu">
                  <li><!-- start notification -->
                    <a href="#">
                      <i class="fa fa-users text-aqua"></i> 5 new members joined today
                    </a>
                  </li>
                  <!-- end notification -->
                </ul>
              </li>
              <li class="footer"><a href="#">View all</a></li>
            </ul>
          </li>
          <!-- Tasks Menu -->
          <li class="dropdown tasks-menu">
            <!-- Menu Toggle Button -->
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              <i class="fa fa-flag-o"></i>
              <span class="label label-danger">9</span>
            </a>
            <ul class="dropdown-menu">
              <li class="header">You have 9 tasks</li>
              <li>
                <!-- Inner menu: contains the tasks -->
                <ul class="menu">
                  <li><!-- Task item -->
                    <a href="#">
                      <!-- Task title and progress text -->
                      <h3>
                        Design some buttons
                        <small class="pull-right">20%</small>
                      </h3>
                      <!-- The progress bar -->
                      <div class="progress xs">
                        <!-- Change the css width attribute to simulate progress -->
                        <div class="progress-bar progress-bar-aqua" style="width: 20%" role="progressbar"
                             aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                          <span class="sr-only">20% Complete</span>
                        </div>
                      </div>
                    </a>
                  </li>
                  <!-- end task item -->
                </ul>
              </li>
              <li class="footer">
                <a href="#">View all tasks</a>
              </li>
            </ul>
          </li>
          <!-- User Account Menu -->
          <li class="dropdown user user-menu">
            <!-- Menu Toggle Button -->
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              <!-- The user image in the navbar-->
              <img src="dist/img/user01.jpg" class="user-image" alt="User Image">
              <!-- hidden-xs hides the username on small devices so only the image appears. -->
              <span class="hidden-xs">Usuario - Gestor de Portafolio</span>
            </a>
            <ul class="dropdown-menu">
              <!-- The user image in the menu -->
              <li class="user-header">
                <img src="dist/img/user01.jpg" class="img-circle" alt="User Image">
                <p>
                  Usuario - Gestor de Portafolio
                  <small>Desde Nov. 2012</small>
                </p>
              </li>
              <!-- Menu Body -->
              <li class="user-body">
                <div class="row">
                  <div class="col-xs-4 text-center">
                    <a href="#">Seguidores</a>
                  </div>
                  <div class="col-xs-4 text-center">
                    <a href="#">Ventas</a>
                  </div>
                  <div class="col-xs-4 text-center">
                    <a href="#">Amigos</a>
                  </div>
                </div>
                <!-- /.row -->
              </li>
              <!-- Menu Footer-->
              <li class="user-footer">
                <div class="pull-left">
                  <a href="#" class="btn btn-default btn-flat">Profile</a>
                </div>
                <div class="pull-right">
                  <a href="#" class="btn btn-default btn-flat">Sign out</a>
                </div>
              </li>
            </ul>
          </li>
          <!-- Control Sidebar Toggle Button -->
          <li>
            <a href="#" data-toggle="control-sidebar"><i class="fa fa-gears"></i></a>
          </li>
        </ul>
      </div>
    </nav>
  </header>
  <!-- Left side column. contains the logo and sidebar -->
  <aside class="main-sidebar">

    <!-- sidebar: style can be found in sidebar.less -->
    <section class="sidebar">

      <!-- Sidebar user panel (optional) -->
      <div class="user-panel">
        <div class="pull-left image">
          <img src="dist/img/user01.jpg" class="img-circle" alt="User Image">
        </div>
        <div class="pull-left info">
          <p>Usuario - Gestor de Portafolio</p>
          <!-- Status -->
          <a href="#"><i class="fa fa-circle text-success"></i> En l&iacute;nea</a>
        </div>
      </div>

      <!-- search form (Optional) -->
      <form action="#" method="get" class="sidebar-form">
        <div class="input-group">
          <input type="text" name="q" class="form-control" placeholder="Buscar...">
          <span class="input-group-btn">
              <button type="submit" name="search" id="search-btn" class="btn btn-flat"><i class="fa fa-search"></i>
              </button>
            </span>
        </div>
      </form>
      <!-- /.search form -->

      <!-- Sidebar Menu -->
      <ul class="sidebar-menu" data-widget="tree">
        <li class="header">Gesti&oacute;n de Portafolio</li>
        <!-- Optionally, you can add icons to the links -->
        <li class="active"><a href="datatable.html?p=proyecto"><i class="fa fa-dashboard"></i> <span>Proyecto</span></a></li>
        <li class="active"><a href="datatable.html?p=iniciativa"><i class="fa fa-pie-chart"></i> <span>Iniciativa</span></a></li>
        <li class="active"><a href="datatable.html?p=portafolio"><i class="fa fa-th"></i> <span>Portafolio</span></a></li>
        <li class="active"><a href="datatable.html?p=programa"><i class="fa fa-files-o"></i> <span>Programa</span></a></li>
        <li class="active"><a href="datatable.html?p=solicitud"><i class="fa fa-table"></i> <span>Solicitud</span></a></li>
        <li class="active"><a href="datatable.html?p=balanceo"><i class="fa fa-calendar"></i> <span>Balanceo</span></a></li>

        <li class="treeview">
          <a href="Requerimiento_1.html"><i class="fa fa-folder"></i> <span>Mantenimiento</span>
            <span class="pull-right-container">
                <i class="fa fa-angle-left pull-right"></i>
              </span>
          </a>
          <ul class="treeview-menu">
            <li><a href="datatable.html?p=categoria"><i class="fa fa-circle-o"></i> Categor&iacute;a</a></li>		  
            <li><a href="datatable.html?p=recurso"><i class="fa fa-circle-o"></i> Recurso</a></li>
            <li><a href="datatable.html?p=usuario"><i class="fa fa-circle-o"></i> Usuario</a></li>
            <li><a href="datatable.html?p=prioridad"><i class="fa fa-circle-o"></i> Prioridad</a></li>
          </ul>
        </li>
      </ul>
      <!-- /.sidebar-menu -->
    </section>
    <!-- /.sidebar -->
  </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        <small></small>
      </h1>
      <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Inicio</a></li>
        <li class="active"></li>
      </ol>
    </section>

    <!-- Main content -->
    <section class="content container-fluid">
        <form role="form">
      <div class="box box-primary" data-format="form" style="display:none" >
        <div class="box-header with-border">
          <h3 class="box-title">Datos deL Requerimiento</h3>
        </div>
        <!-- /.box-header -->
        <!-- form start -->
      
          <div class="box-body">
            <div class="row">
              <div class="col-md-4" id="field001">
                <div class="form-group">
                  <label for="exampleInputFile">C&oacute;digo</label>
                  <input type="text" class="form-control" id="input02">
                </div>
              </div>
            </div>
          </div>
          <!-- /.box-body -->
     
      </div>
    
      <div class="row">
          <div class="col-md-12">
      <div id="box-command" class="box box-primary" data-format="form" style="display:none" >
          <!-- /.box-header -->
          <!-- form start -->
            <div class="box-body" align="right" >
                <button type="button" id="button3" class="btn btn-primary">Actualizar</button>
                <button type="button" id="button4" class="btn btn-primary">Eliminar</button>
            </div>
            <!-- /.box-body -->      
          </div>
        </div>                      
    </div>
  </form>     
      <div class="box box-primary" data-format="table"  style="display:none" >
        <div class="box-header with-border">
          <h3 class="box-title"></h3>
        </div>
        <!-- /.box-header -->
        <div class="box-body">
          <table id="example1" class="table table-bordered table-striped">
          </table>
        </div>
        <!-- /.box-body -->
        <div class="box-footer" align="right">
        </div>
      </div>
      <!-- /.box -->

      <!--------------------------
      | Your Page Content Here |
       -------------------------->
       <div class="modal fade" id="modal-default">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title"></h4>
            </div>
            <div class="modal-body">
              <p></p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Cerrar</button>
            </div>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div>
      <!-- /.modal -->

      <div class="modal modal-primary fade" id="modal-primary"  >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title"></h4>
            </div>
            <div class="modal-body">
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-outline pull-left" data-dismiss="modal">Cerrar</button>
            </div>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div>
      <!-- /.modal -->

      <div class="modal modal-info fade" id="modal-info">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title">Info Modal</h4>
            </div>
            <div class="modal-body">
              <p>One fine body&hellip;</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-outline pull-left" data-dismiss="modal">Cerrar</button>
              <button type="button" class="btn btn-outline">Aplicar</button>
            </div>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div>
      <!-- /.modal -->

      <div class="modal modal-warning fade" id="modal-warning">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title">Warning Modal</h4>
            </div>
            <div class="modal-body">
              <p>One fine body&hellip;</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-outline pull-left" data-dismiss="modal">Cerrar</button>
              <button type="button" class="btn btn-outline">Aplicar</button>
            </div>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div>
      <!-- /.modal -->

      <div class="modal modal-success fade" id="modal-success">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title">Success Modal</h4>
            </div>
            <div class="modal-body">
              <p>One fine body&hellip;</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-outline pull-left" data-dismiss="modal">Cerrar</button>
              <button type="button" class="btn btn-outline">Aplicar</button>
            </div>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div>
      <!-- /.modal -->

      <div class="modal modal-danger fade" id="modal-danger">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title">Danger Modal</h4>
            </div>
            <div class="modal-body">
              <p>One fine body&hellip;</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-outline pull-left" data-dismiss="modal">Cerrar</button>
              <button type="button" class="btn btn-outline">Aplicar</button>
            </div>
          </div>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div>
      <!-- /.modal -->    
    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->

  <!-- Main Footer -->
  <footer class="main-footer">
    <!-- To the right -->
    <div class="pull-right hidden-xs">
      Taller de Proyectos 2
    </div>
    <!-- Default to the left -->
    <strong>Copyright &copy; 2016 <a href="#">Company</a>.</strong> All rights reserved.
  </footer>

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Create the tabs -->
    <ul class="nav nav-tabs nav-justified control-sidebar-tabs">
      <li class="active"><a href="#control-sidebar-home-tab" data-toggle="tab"><i class="fa fa-home"></i></a></li>
      <li><a href="#control-sidebar-settings-tab" data-toggle="tab"><i class="fa fa-gears"></i></a></li>
    </ul>
    <!-- Tab panes -->
    <div class="tab-content">
      <!-- Home tab content -->
      <div class="tab-pane active" id="control-sidebar-home-tab">
        <h3 class="control-sidebar-heading">Recent Activity</h3>
        <ul class="control-sidebar-menu">
          <li>
            <a href="javascript:;">
              <i class="menu-icon fa fa-birthday-cake bg-red"></i>

              <div class="menu-info">
                <h4 class="control-sidebar-subheading">Langdon's Birthday</h4>

                <p>Will be 23 on April 24th</p>
              </div>
            </a>
          </li>
        </ul>
        <!-- /.control-sidebar-menu -->

        <h3 class="control-sidebar-heading">Tasks Progress</h3>
        <ul class="control-sidebar-menu">
          <li>
            <a href="javascript:;">
              <h4 class="control-sidebar-subheading">
                Custom Template Design
                <span class="pull-right-container">
                    <span class="label label-danger pull-right">70%</span>
                  </span>
              </h4>

              <div class="progress progress-xxs">
                <div class="progress-bar progress-bar-danger" style="width: 70%"></div>
              </div>
            </a>
          </li>
        </ul>
        <!-- /.control-sidebar-menu -->

      </div>
      <!-- /.tab-pane -->
      <!-- Stats tab content -->
      <div class="tab-pane" id="control-sidebar-stats-tab">Stats Tab Content</div>
      <!-- /.tab-pane -->
      <!-- Settings tab content -->
      <div class="tab-pane" id="control-sidebar-settings-tab">
        <form method="post">
          <h3 class="control-sidebar-heading">General Settings</h3>

          <div class="form-group">
            <label class="control-sidebar-subheading">
              Report panel usage
              <input type="checkbox" class="pull-right" checked>
            </label>

            <p>
              Some information about this general settings option
            </p>
          </div>
          <!-- /.form-group -->
        </form>
      </div>
      <!-- /.tab-pane -->
    </div>
  </aside>
  <!-- /.control-sidebar -->
  <!-- Add the sidebar's background. This div must be placed
  immediately after the control sidebar -->
  <div class="control-sidebar-bg"></div>
</div>
<!-- ./wrapper -->

<!-- REQUIRED JS SCRIPTS -->

<!-- jQuery 3 -->
<script src="bower_components/jquery/dist/jquery.min.js"></script>
<!-- Bootstrap 3.3.7 -->
<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- moment -->
<script src="bower_components/moment/min/moment-with-locales.min.js"></script>
<!-- bootstrap datepicker -->
<script src="bower_components/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
<script src="bower_components/bootstrap-datepicker/dist/locales/bootstrap-datepicker.es.min.js"></script>
<!-- BootBox -->
<script src="custom_components/bootbox.js/4.4.0/bootbox.min.js"></script>
<!-- DataTables -->
<script src="bower_components/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
<script src="custom_components/datatables/buttons/1.5.3/js/dataTables.buttons.min.js"></script>
<script src="custom_components/datatables/select/1.2.7/js/dataTables.select.min.js"></script>
<!-- Select2 -->
<script src="bower_components/select2/dist/js/select2.full.min.js"></script>
<!-- iCheck 1.0.1 -->
<script src="plugins/iCheck/icheck.min.js"></script>
<!-- SlimScroll -->
<script src="bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<!-- FastClick -->
<script src="bower_components/fastclick/lib/fastclick.js"></script>
<!-- AdminLTE App -->
<script src="dist/js/adminlte.min.js"></script>

<!-- Optionally, you can add Slimscroll and FastClick plugins.
     Both of these plugins are recommended to enhance the
     user experience. -->
<!-- AdminLTE for demo purposes -->
<script src="dist/js/demo.js"></script>
<!-- page script -->
<script>
$.urlParam = function(name){
var results = new RegExp('[\?&]' + name + '=([^&]*)').exec(decodeURIComponent(window.location.search));
    if (results==null){
       return null;
    }
    else{
       return results[1] || 0;
    }
}
var adata;
var tdata; 
var tdata2; 
var p = $.urlParam('p')||'';
var c = $.urlParam('c')||'';
var k = $.urlParam('k')||'';
var r = $.urlParam('r')||'';

var tid = $.urlParam('t')||'';
var tai = [];
var tk = [];
dtables ={};
dcolumns={};
drefs ={};
cmdId=0;
cmds={commands:{cmd:[]}};
  $(function () {
    $('button#button3').click(function () {

      bootbox.confirm({title:"Confirmaci&oacute;n",message:"Desea actualizar este registro",className:"modal-primary",
      buttons: {confirm: {label: 'Si'},cancel: {label: 'No'}},
      callback: function(result){ 
      if(!result) return;
      var cdata = []
      tdata[0]['xs:complexType']['xs:attribute'].forEach(function (v, i, a) {
        if (v['@type'] == "xs:dateTime" && !v['option']) {
          if(k ==""){
              var m = window.moment(dcolumns[v['@name']].val(),"DD/MM/YYYY",'es', true );
              if((dcolumns[v['@name']].val()||"")!=""&&m.isValid())cdata.push({"@name":v['@name'],"@value":m.format("YYYY-MM-DD")})
          }else{
              var m = window.moment(adata[0]["@"+v['@name']],moment.ISO_8601,'es', true );
              if((dcolumns[v['@name']].val()||"")!=(m.isValid()?m.format("DD/MM/YYYY"):"")&&m.isValid())cdata.push({"@name":v['@name'],"@value":window.moment(dcolumns[v['@name']].val(),"DD/MM/YYYY",'es', true ).format("YYYY-MM-DDTHH:mm:ss")})
          }
        }
        else if ((v['@type'] == "xs:int" || v['@type'] == "xs:decimal") && !v['option']) {
          if(k ==""){  
            if((dcolumns[v['@name']].val()||"")!="")cdata.push({"@name":v['@name'],"@value":dcolumns[v['@name']].val()})
          }else{    
            if(dcolumns[v['@name']].val()!=adata[0]["@"+v['@name']])cdata.push({"@name":v['@name'],"@value":dcolumns[v['@name']].val()})
          }
        }
        else if (v['@type'] == "xs:boolean" && !v['option']) {
          if(k ==""){  
          if(dcolumns[v['@name']].prop('checked')==$.parseJSON('true')) cdata.push({"@name":v['@name'],"@value":'true'})
          }else{
          if(dcolumns[v['@name']].prop('checked')!=$.parseJSON(adata[0]["@"+v['@name']])) cdata.push({"@name":v['@name'],"@value":dcolumns[v['@name']].prop('checked')?'true':'false'})
          }          
        } else {
          if(k ==""){  
            if((dcolumns[v['@name']].val()||"")!="")cdata.push({"@name":v['@name'],"@value":dcolumns[v['@name']].val()})
          }else{   
            if((dcolumns[v['@name']].val()||"")!=(adata[0]["@"+v['@name']]||""))cdata.push({"@name":v['@name'],"@value":dcolumns[v['@name']].val()})
          }
        }           
      })
      if(r!="")r.split('\t').reduce(function(p,v,i,a){if(i%2==0)p.push({"@name":v,"@value":a[i+1]});return p},cdata)
      cmds.commands.cmd.push({"@cmdid":cmdId++,"@tid":tid,"aid":tai.map(function(v){return ({"@name":v})}),"@cmd":k==""?"insert":"update","key":k==""?tk.map(function(v){return ({"@name":v})}) :k.split('\t').reduce(function(p,v,i,a){if(i%2==0)p.push({"@name":v,"@value":a[i+1]});return p},[]),"data":cdata})
      $.fn.postdata()
    }});      
    })

    $('button#button4').click(function () {

      bootbox.confirm({title:"Confirmaci&oacute;n",message:"Desea eliminar este registro",className:"modal-primary",
      buttons: {confirm: {label: 'Si'},cancel: {label: 'No'}},
      callback: function(result){ 
      if(!result) return;

      var cdata = []
      cmds.commands.cmd.push({
        "@cmdid":cmdId++,
        "@tid":tid,
        "@cmd":"delete",
        "key":k==""?[]:k.split('\t').reduce(function(p,v,i,a){if(i%2==0)p.push({"@name":v,"@value":a[i+1]});return p},[]),
        "data":cdata
        })
      $.fn.postdata()
      
      }}
      )
    })

    $.fn.postdata = function() {
      var jqxhr = $.post( "./data/?p="+p+"&k="+encodeURIComponent(k)+"&t="+tid+"&c=upd",JSON.stringify(cmds), function(data) {
        data = JSON.parse(data);
        var msg =[];

        ((data.command.commands.cmd)||[]).forEach(function(v,i,a){
          var ix = cmds.commands.cmd.findIndex(function(vv,ii,aa){return v["@cmdid"]==vv["@cmdid"]})
          if(v["@error"]!="0") msg.push(v["@errormessage"])
          if (ix>=0) cmds.commands.cmd.splice(ix,1)
        })

        if(msg.length==0){
          bootbox.alert({title:"Aviso",message:"Datos Actualizados exitosamente",className:"modal-success"})

          adata = data.data.NewDataSet[tdata[0]['@name']];

          if (c == "e") {
            k = tk.map(function(vv){return vv+ "\t"+ adata[0]["@" + vv]}).join("\t") 
            tdata[0]['xs:complexType']['xs:attribute'].forEach(function (v, i, a) {
              if (v['@visible'] == '0') {
                if(dcolumns[v['@name']].val()!=adata[0]["@" + v['@name']]) dcolumns[v['@name']].val(adata[0]["@" + v['@name']])
              } else {


                if (v['option']) {
                  if(dcolumns[v['@name']].val()!=adata[0]["@" + v['@name']]) dcolumns[v['@name']].val(adata[0]["@" + v['@name']]).trigger('change')
                }
                if (v['@type'] == "xs:string" && !v['option'] ) {
                  if(dcolumns[v['@name']].val()!=adata[0]["@" + v['@name']]) dcolumns[v['@name']].val(adata[0]["@" + v['@name']])
                }
                if (v['@type'] == "xs:dateTime" && !v['option']) {
                  var m = window.moment(adata[0]["@"+v['@name']],moment.ISO_8601,'es', true );
                  if(dcolumns[v['@name']].val()!=(m.isValid()?m.format("DD/MM/YYYY"):'n/a')) dcolumns[v['@name']].val((m.isValid()?m.format("DD/MM/YYYY"):'n/a'))

                }
                if ((v['@type'] == "xs:int" || v['@type'] == "xs:decimal") && !v['option']) {
                  if(dcolumns[v['@name']].val()!=adata[0]["@" + v['@name']]) dcolumns[v['@name']].val(adata[0]["@" + v['@name']])
                }
                if (v['@type'] == "xs:boolean" && !v['option']) {
                  if($.parseJSON(adata[0]["@"+v['@name']])!= dcolumns[v['@name']].is(':checked')) $.parseJSON(adata[0]["@"+v['@name']])?dcolumns[v['@name']].iCheck('check'):dcolumns[v['@name']].iCheck('uncheck');
                }

              }
            })
          }


        (tdata.filter(function(v,i,a){return (c=='e'&&i>0)||(c!='e'&&i==0)}).concat(tdata2)).forEach(function(vv,ii,aa){
          var wdata = data.data.NewDataSet[vv["@name"]]||data.data.NewDataSet[tid][0][vv["@name"]]||[]
          dtables[vv["@name"]].rows().remove(); 
          dtables[vv["@name"]].rows.add(wdata); 
          dtables[vv["@name"]].draw();

        })


        
        }else{
          bootbox.confirm({
            title:"Error",
            message:msg.join("\n"),
            className:"modal-danger",
            buttons: {confirm: {label:'Salir'}, cancel:{label: 'Mas Datos'}},
            callback:function(result){
              if(!result){
                bootbox.alert({title:"Detalle" ,message:JSON.stringify(data.command.commands),className:"modal-primary"})
              }
            }
          })
        }
      })
      .fail(function(xhr, textStatus, errorThrown) {
        bootbox.alert(xhr.responseText);
      });
      return ;
   }; 

  $( document ).ready(function() {
   var jqxhr = $.post( "./data/?p="+p+"&k="+encodeURIComponent(k)+"&t="+tid+"&c=init", function(data) {

    data = JSON.parse(data);
    tdata =[];
    tdata2 =[];	
    $('.content-header h1').prepend(data.schema['xs:schema']['xs:element']['@title']||'T&iacute;tulo');
    $('.breadcrumb .active').prepend(data.schema['xs:schema']['xs:element']['@title']||'T&iacute;tulo');
    $('.content-header h1 small').prepend(data.schema['xs:schema']['xs:element']['@subtitle']||'Subt&iacute;tulo')
    document.title= $('<div/>').html("Gesti&oacute;n de Portafolio | "+data.schema['xs:schema']['xs:element']['@title']||'T&iacute;tulo').text();

    var tschm = data.schema['xs:schema']['xs:element']['xs:complexType']['xs:choice']['xs:element'];
    var ax=[],ay=[]
    for (n in  tschm){
      if(tschm[n]["@name"].indexOf('.select')<0)tdata.push(tschm[n]);
      var tschm2 =tschm[n]["xs:complexType"]["xs:sequence"]
      if(tschm2) tschm2 =tschm2['xs:element']
      if(tschm2) for(n2 in tschm2 ){
        if(tschm2[n2]["@name"].indexOf('.select')<0)tdata.push(tschm2[n2]);
		if(tschm2[n2]["@option"]) tdata2.push(tschm.find(function(v,i,a){return v["@name"]== tschm2[n2]["@option"]}))
      }
	  if (tschm[n]["@option"]) tdata2.push(tschm.find(function(v,i,a){return v["@name"]== tschm[n]["@option"]}))
    }


    var tid =tschm[0]["@name"];
    if (tdata.length==0) return;
    adata = data.data.NewDataSet[tdata[0]['@name']];
    
     if (c == "e"||tschm[0]["@data-form"]=="1" ) {
       $('div.box-primary[data-format="form"] h3.box-title').text(tdata[0]['@caption'])
       $('div.box-primary[data-format="form"]').show();
       var d = $('div.box-primary[data-format="form"] #field001');
       tai= (tdata[0]['xs:complexType']['xs:attribute'].filter(function(v,i,a){return v["@msdata:AutoIncrement"]=="true" })||[]).map(function(v,i,a){return v["@name"] })
       tk = ((data.schema['xs:schema']["xs:element"]["xs:unique"]||[]).filter(function(v,i,a){return v["xs:selector"]["@xpath"]==".//"+tid })[0]||{'xs:field':[]})["xs:field"].map(function(v,i,a){return v["@xpath"].substr(1) })
       tdata[0]['xs:complexType']['xs:attribute'].forEach(function (v, i, a) {
         if (v['@visible'] == '0') {
           d1=$("<input type='hidden'>")
           d1.val(k==''?'':adata[0]["@"+v['@name']])
           $('div.box-primary[data-format="form"]').append(d1)
           dcolumns[v['@name']]=d1
         } else {
           var d1 = d.clone().appendTo('div.box-primary[data-format="form"] .row');
           d1.find("label").html(v['@caption'] || v['@name'])
           if (v['option']) {
              d1.find("input").replaceWith("<select class='form-control select2' style='width: 100%;'></select>")
              v['option'].forEach(function (v1, i, a) { d1.find("select").append($("<option>", { value: v1['@key'], text: v1['@value'] })) });
              d1.find("select").val(k==''?'':adata[0]["@"+v['@name']])
              if(v['@readonly']=='1'){
                d1.find("select").attr("readonly", true);
              }
              dcolumns[v['@name']]=d1.find("select") 
           }
           if (v['@type'] == "xs:string" && !v['option'] && parseInt(v['@length']) <= 25) {
            d1.find("input").attr('maxlength', v['@length']).val(k==''?'':adata[0]["@"+v['@name']]);
            dcolumns[v['@name']]=d1.find("input")
           }
           if (v['@type'] == "xs:string" && !v['option'] && parseInt(v['@length']) > 25) {
             d1.find("input").replaceWith("<textarea  class='form-control' rows='3' placeholder='Texto ...' ></textarea>")
             d1.find("textarea").val(k==''?'':adata[0]["@"+v['@name']])             
             dcolumns[v['@name']]=d1.find("textarea")             
           }
           if (v['@type'] == "xs:dateTime" && !v['option']) {
             d1.find("input").replaceWith("<div class='input-group date'><div class='input-group-addon'><i class='fa fa-calendar'></i></div><input type='text' class='form-control pull-right datepicker' ></div>")
             var m = window.moment(adata[0]["@"+v['@name']],moment.ISO_8601,'es', true );
             d1.find("input").val(k==''?'':(m.isValid()?m.format("DD/MM/YYYY"):'n/a'))
             dcolumns[v['@name']]=d1.find("input")             
           }
           if ((v['@type'] == "xs:int" || v['@type'] == "xs:decimal") && !v['option']) {
             d1.find("input").attr('type', 'number').val(k==''?'':adata[0]["@"+v['@name']])
             dcolumns[v['@name']]=d1.find("input")             
           }
           if (v['@type'] == "xs:boolean" && !v['option']) {
             d1.find("input").attr('type', 'checkbox')
             d1.find("input").attr('value', '1')             
             d1.find("input").addClass('icheck')             
             if(k==''?false:$.parseJSON(adata[0]["@"+v['@name']])==true) d1.find("input").prop('checked', true);
             dcolumns[v['@name']]=d1.find("input")    
           }
           if(v['@readonly']=='1'){
              dcolumns[v['@name']].prop("readonly", true);
            }           
         }

       })
       d.hide();
       (tdata[0]['command']||[]).forEach(function (v, i, a) {
          d1=$("<button type='button' id='button4' class='btn btn-primary'></button>")
          d1.text(v['@caption'])
          $('#box-command.box-primary[data-format="form"] .box-body').prepend(d1)         
       } )

       $('.select2:not([readonly])').select2();
       $('.select2[readonly]').select2({disabled:true});       
     

       $('.datepicker:not([readonly])').datepicker({
         autoclose: true,
         format:  "dd/mm/yyyy",
         language: 'es'

       });


       $('.icheck').iCheck({
        checkboxClass: 'icheckbox_square-blue',
        radioClass: 'iradio_square-blue',
        increaseArea: ''}
       );       
       $('.icheck[readonly]').iCheck('disable');

        if(tschm[0]["@data-form"]=="1"){
          $('div.box-primary[data-format="form"]').appendTo("#modal-default .modal-body") 
          $("#modal-default").on("hidden.bs.modal", function () {
              bModal=false
              k = ""
              $.fn.postdata()
          });
          $('div.box-primary[data-format="form"] #button4').hide()
        }


     }

	 
    var d = $('div.box-primary[data-format="table"]'); 
    (tdata.filter(function(v,i,a){return (c=='e'&&i>0)||(c!='e'&&i==0)}).concat(tdata2)).forEach(function(vv,ii,aa){


    var d1 = d.clone().appendTo('section.content');
    if(tdata2.includes(vv)){
      var wdata = data.data.NewDataSet[vv['@name']]      
      var d1 = $('#modal-primary').clone()
      d1.appendTo('section.content')
		  d1.attr("id","modal_"+vv["@name"].replace(".","_"));
		  d1.find('.modal-title').text(tdata.find(function(v){return v["@name"]==(vv["@name"].split(".")[0]) })["@optioncaption"]||'Seleccionar');
      $('<table id="example1" class="table cell-border compact">').appendTo(d1.find('.modal-body'))
      var t =vv["@name"];
      drefs[t]={selectcols:vv["@selectcols"].split(","),tablecols:vv["@tablecols"].split(",")}
    } else{
      var wdata = (vv["@name"]==tid)?adata||[]:adata[0][vv["@name"]]||[]
      d1.show();   
      d1.find('h3.box-title').text(vv['@caption'])
      var t =vv["@name"];
      d1.attr('id', t)
      drefs[t]=!vv["xs:annotation"]?{}:{parentcols:vv["xs:annotation"]["xs:appinfo"]["msdata:Relationship"]["@msdata:parentkey"].split(" "),childcols:vv["xs:annotation"]["xs:appinfo"]["msdata:Relationship"]["@msdata:childkey"].split(" ")}

    } 
    acolumns= vv['xs:complexType']['xs:attribute']
              .map(function(a){var b = {data:'@'+a['@name'],title:a['@caption']||a['@name'],defaultContent: "",
                                        visible:a['@visible']=='0'?false:true};
                              if(a['option']){
                                b.className="dt-body-nowrap";
                                b.render=function(data, type, row, meta){return a['option'].reduce(function(p,c,i,a){return c['@key']==data?c['@value']:p },"n/a") };
                              }
                              if(a['@type']=="xs:string" && !a['option'])b.width=a['@width']? parseInt(a['@width']):Math.min(parseInt(a['@length'])* 8,200 ) ;
                              if(a['@type']=="xs:dateTime" && !a['option']){
                                b.width=a['@width']? parseInt(a['@width']):20*8  ;                              
                                b.type="date";
                                b.render=function(data, type, row, meta){var m = window.moment(data,moment.ISO_8601,'es', true );return type=='display'?(m.isValid()?m.format("DD/MM/YYYY k:mm:ss"):'n/a'):data}
                              }
                              if((a['@type']=="xs:int"||a['@type']=="xs:decimal") && !a['option'] ){
                                b.width=a['@width']? parseInt(a['@width']):8*8  ;                              
                                b.type="num-fmt";
                                b.className="dt-body-right";
                                b.render= $.fn.dataTable.render.number( ',', '.',a['@type']=="xs:int"?0:a['@decimals']? parseInt(a['@decimals']):2  )
                              }
                              if(a['@type']=="xs:boolean" && !a['option']){
                                b.render= function (data, type, row) {return type=='display'?(($.parseJSON(data) === true) ? '<span class="glyphicon glyphicon-ok"></span>' : '<span class="glyphicon glyphicon-remove"></span>'):data;}
                              }
   
                              return b;}

                  )
    acolumns.unshift({className:"select-checkbox",title:"<i class='fa fa-check-square-o'></i><i class='fa fa-refresh'></i>",orderable: false,defaultContent: "",width:8});
    d1.find('#example1').DataTable(
        {
    'dom': 'Bfrtip',
    'lengthChange': false,
	  'scrollX': true,
    'rowId':(data.schema['xs:schema']["xs:element"]["xs:unique"].filter(function(v,i,a){return v["xs:selector"]["@xpath"]==".//"+t })[0]||{'xs:field':[]})["xs:field"].map(function(v,i,a){return v["@xpath"] }),
    'select': {
            style:    'multi+shift',
            selector: 'td.select-checkbox'
        },
        order: [[ 1, 'asc' ]],
	  'columns': acolumns,
    'pageLength':tdata2.includes(vv)?6:10,
    'buttons': tdata2.includes(vv)?[]:[
            {
                text: 'Nuevo',
                action: function ( e, dt, node, config ) {
                  if(tschm[0]["@data-form"]=="1" ){
                  
                    tdata[0]['xs:complexType']['xs:attribute'].forEach(function (v, i, a) {
                        if (v['@type'] == "xs:boolean" && !v['option']) {
                          dcolumns[v['@name']].iCheck('uncheck');
                        }else{
                          dcolumns[v['@name']].val('')
                        } 
                    })
                    $('#modal-default').modal("show")
                  }else{
                    window.location.href = "datatable.html?p="+p+"&k=&c=e&r="+(!drefs[t].childcols?"":drefs[t].childcols.map(function(v,i,a){return v+"%09"+(adata[0]["@"+drefs[t].parentcols[i]]||"")}).join("%09"))+"&t="+t
                  }
                }
            },
            {
                text: 'Eliminar',
                action: function ( e, dt, node, config ) {
                  bootbox.confirm({title:"Confirmaci&oacute;n",message:"Desea eliminar los Registros Marcados",className:"modal-primary",
                    buttons: {confirm: {label: 'Si'},cancel: {label: 'No'}},
                    callback: function(result){ 
                      if(!result) return;

                          dtables[t].rows( { selected: true } ).data().map(function(v,i,a){cmds.commands.cmd.push({
                              "@cmdid":cmdId++,
                              "@tid":t,
                              "@cmd":"delete",
                              "key": dtables[t].context[0].rowId.map(function(vv,ii,aa){return {"@name":vv.substr(1),"@value":v[vv]}}),
                              "data":[]                              
                            })});

                            $.fn.postdata()


                    }
                  })


                }
            } 
        ].concat(vv["@option"]?[{text:vv["@optioncaption"]||"",attr:{"data-toggle": "modal","data-target":"#modal_"+vv["@name"]+"_select" },action:function(e, dt, node, config){}}]:[])
		.concat((vv["command"]||[]).map(function(a){return{text:a["@caption"],action:function(e, dt, node, config){
                  bootbox.confirm({title:"Confirmaci&oacute;n",message:a["@message"],className:"modal-primary",
                    buttons: {confirm: {label: 'Si'},cancel: {label: 'No'}},
                    callback: function(result){ 
                      if(!result) return;
                          dtables[t].rows( { selected: true } ).data().map(function(v,i,a0){cmds.commands.cmd.push({
                              "@cmdid":cmdId++,
                              "@tid":t,
                              "@cmd":a["@type"],
                              "@commandid":a["@id"],
                              "key": dtables[t].context[0].rowId.map(function(vv,ii,aa){return {"@name":vv.substr(1),"@value":v[vv]}}),
                              "data":[]                              
                            })});

                            $.fn.postdata()


                    }
                  })
			
		
		}}}) )
        ,
    'language' : {
                "sProcessing":     "Procesando...",
                "sLengthMenu":     "Mostrar _MENU_ registros",
                "sZeroRecords":    "No se encontraron resultados",
                "sEmptyTable":     "Ning&uacute;n dato disponible en esta tabla",
                "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
                "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0 registros",
                "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
                "sInfoPostFix":    "",
                "sSearch":         "Buscar:",
                "sUrl":            "",
                "sInfoThousands":  ",",
                "sLoadingRecords": "Cargando...",
                "oPaginate": {
                    "sFirst":    "Primero",
                    "sLast":     "&Uacute;ltimo",
                    "sNext":     "Siguiente",
                    "sPrevious": "Anterior"
                },
                "oAria": {
                    "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
                    "sSortDescending": ": Activar para ordenar la columna de manera descendente"
                },
                "select": {
                  "rows": {
                      _: "%d filas seleccionadas",
                      0: "Click en una fila para seleccionar",
                      1: "Solo una fila seleccionada"
                  }
              }

            }
      }
    )
    dtables[t]=d1.find('#example1').DataTable();
    dtables[t].rows().remove(); 
    dtables[t].rows.add(wdata); 

    if(tdata2.includes(vv)){
      d1.show();
      dtables[t].columns.adjust().draw();
      d1.hide(); 




      d1.find(".modal-footer button:not([data-dismiss])").on('click', function (e) {

        bootbox.confirm({title:"Confirmaci&oacute;n",message:"Desea actualizar este registro",className:"modal-primary",
          buttons: {confirm: {label: 'Si'},cancel: {label: 'No'}},
          callback: function(result){ 
            if(!result) return;

                dtables[t].rows( { selected: true } ).data().map(function(v,i,a){cmds.commands.cmd.push({
                    "@cmdid":cmdId++,
                    "@tid":t.split(".")[0],
                    "@cmd":"insert",
                    "key":[],
                    "data":drefs[t].tablecols.map(function(vv,ii,aa){return {"@name":vv,"@value":v["@"+drefs[t].selectcols[ii]]}})
                      .concat(drefs[t.split(".")[0]].childcols.map(function(vv,ii,aa){return {"@name":vv,"@value":adata[0]["@"+drefs[t.split(".")[0]].parentcols[ii]]}}))
                  })});
                  $.fn.postdata()
          }
        })
 
      })


    }else{
      dtables[t].columns.adjust().draw();      
      d1.find('#example1 tbody').on( 'click', 'td', function () {
        if($(this).hasClass("select-checkbox")) return;
        var r = dtables[t].row($(this).parent().get(0)).data();
        var h = "datatable.html?p="+p+"&k="
        h += dtables[t].context[0].rowId.map(function(v,i,a){return v.substr(1)+"%09"+r[v]}).join("%09")
        h += "&r="
        h += !drefs[t].childcols?"":drefs[t].childcols.map(function(v,i,a){return v+"%09"+(adata[0]["@"+drefs[t].parentcols[i]]||"")}).join("%09")        
        h = h+"&c=e&t="+t
        if(tschm[0]["@data-form"]=="1" ){
          tdata[0]['xs:complexType']['xs:attribute'].forEach(function (v, i, a) {
              if (v['@visible'] == '0') {
                dcolumns[v['@name']].val(r["@"+v['@name']])
              } else {
                if (v['option']) {
                   dcolumns[v['@name']].val(r["@"+v['@name']]).trigger('change')
                }
                if (v['@type'] == "xs:string" && !v['option'] ) {
                  dcolumns[v['@name']].val(r["@"+v['@name']])
                }
                if (v['@type'] == "xs:dateTime" && !v['option']) {
                  var m = window.moment(r["@"+v['@name']],moment.ISO_8601,'es', true );
                  dcolumns[v['@name']].val((m.isValid()?m.format("DD/MM/YYYY"):'n/a'))

                }
                if ((v['@type'] == "xs:int" || v['@type'] == "xs:decimal") && !v['option']) {
                  dcolumns[v['@name']].val(r["@"+v['@name']])
                }
                if (v['@type'] == "xs:boolean" && !v['option']) {
                  $.parseJSON(r["@"+v['@name']])?dcolumns[v['@name']].iCheck('check'):dcolumns[v['@name']].iCheck('uncheck');
                }

              }
            })
          k=tk.map(function(vvv){return vvv+ "\t"+ r["@" + vvv]}).join("\t")
          $('#modal-default').modal("show")
        }else{
          window.location.href =h
        }
    } );
	
    }

    d1.find('.dataTables_scrollHeadInner table.dataTable thead th.select-checkbox i.fa-check-square-o').on( 'click', function () {
      dtables[t].rows().select();
    } );          
    d1.find('.dataTables_scrollHeadInner table.dataTable thead th.select-checkbox i.fa-refresh').on( 'click', function () {
      var idx = dtables[t].rows({selected:true});
      dtables[t].rows({selected:false}).select();
      dtables[t].rows(idx[0]).deselect();     
    } );         
	
    })
})

  .done(function() {

  })
  .fail(function(xhr, textStatus, errorThrown) {
        bootbox.alert(xhr.responseText);
      })
  .always(function() {

  });
});  


  })
</script>
</body>
</html>